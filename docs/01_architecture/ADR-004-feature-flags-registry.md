# ADR 4: Единый реестр Feature-флагов

- **Дата**: 2024-08-23
- **Статус**: Accepted

## Контекст
В документах (`Blueprint` и `Stage 1 Playbook`) возникли расхождения в списках feature-флагов. Для избежания путаницы и обеспечения консистентности необходим единый источник правды.

## Решение
Мы создаем данный документ как **единый реестр всех feature-флагов** в системе. Все новые флаги должны добавляться сюда. Файл `src/lib/iam/config.ts` (или аналогичный) является программной реализацией этого реестра.

## Реестр Feature-флагов

### Домен: IAM (Identity & Access Management)
| Флаг | Переменная окружения | По умолчанию | Описание |
|---|---|---|---|
| Аутентификация | `FEATURE_ACCOUNT` | `true` | Включает/выключает всю систему личных кабинетов и аутентификации. |
| Реальные SMS | `FEATURE_REAL_SMS` | `false` | `false`: используется провайдер-заглушка (вывод в консоль). `true`: используется реальный SMS-шлюз. |
| CAPTCHA | `FEATURE_CAPTCHA` | `false` | Включает CAPTCHA после нескольких неудачных попыток входа. |
| Выпуск JWT | `FEATURE_JWT_ISSUING` | `false` | Включает выпуск JWT-токенов после успешной аутентификации для API. |

### Домен: i18n (Интернационализация)
| Флаг | Переменная окружения | По умолчанию | Описание |
|---|---|---|---|
| Локализация | `FEATURE_I18N` | `true` | Включает систему локализации (i18n) для UI, как минимум RU/EN. |

### Домен: Payments (Платежи)
| Флаг | Переменная окружения | По умолчанию | Описание |
|---|---|---|---|
| Онлайн-оплаты | `FEATURE_PAYMENTS_ONLINE` | `false` | Включает интеграцию с онлайн-провайдерами платежей. |

### Домен: Booking (Бронирования)
| Флаг | Переменная окружения | По умолчанию | Описание |
|---|---|---|---|
| Seat Sharing | `FEATURE_SEAT_SHARING` | `false` | Включает функционал совместных поездок (per-seat). |

### Домен: Partners (Партнеры)
| Флаг | Переменная окружения | По умолчанию | Описание |
|---|---|---|---|
| Партнерский портал | `FEATURE_PARTNER_PORTAL`| `false` | Включает доступ к партнерскому порталу. |


## Последствия
- Все разработчики обязаны синхронизировать добавляемые флаги с этим документом.
- Файл `.env.example` должен отражать все перечисленные здесь переменные окружения.
